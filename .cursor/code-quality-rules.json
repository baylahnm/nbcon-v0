{
  "name": "Code Quality Bot Rules",
  "description": "Automated code quality checks for nbcon - Updated Jan 28, 2025 with AI-Powered Dashboards",
  "version": "3.0.0",
  "rules": [
    "=== CODE QUALITY BOT - AUTOMATED CHECKS ===",
    "",
    "Run: node scripts/code-quality-bot.cjs",
    "CI/CD: Runs automatically on push and PR",
    "Schedule: Daily at 2 AM UTC",
    "",
    "=== PRIORITY LEVELS ===",
    "ðŸ”´ CRITICAL - Security vulnerabilities, data corruption risks",
    "ðŸŸ  HIGH - Broken functionality, type safety issues",
    "ðŸŸ¡ MEDIUM - Code quality, maintainability",
    "ðŸŸ¢ LOW - Style, optimization opportunities",
    "",
    "=== AUTOMATED CHECKS (18 Total) ===",
    "",
    "1. Hardcoded Locales (i18n)",
    "   Pattern: toLocaleDateString('en-US'), Intl.NumberFormat('en-US')",
    "   Fix: Use formatSAR(), formatDate() from i18n utils",
    "   Severity: HIGH",
    "",
    "2. Full Page Reloads (SPA)",
    "   Pattern: window.location.assign(), window.location.href =",
    "   Fix: Use navigate() from React Router",
    "   Severity: MEDIUM",
    "",
    "3. XSS Vulnerabilities",
    "   Pattern: dangerouslySetInnerHTML, innerHTML =, eval()",
    "   Fix: Use DOMPurify.sanitize()",
    "   Severity: CRITICAL",
    "",
    "4. Swallowed Errors",
    "   Pattern: catch () {}, .catch(() => {})",
    "   Fix: Log with errorMonitor.logError()",
    "   Severity: MEDIUM",
    "",
    "5. Hardcoded Dark Mode Colors",
    "   Pattern: dark:bg-[#..], dark:text-[#..]",
    "   Fix: Use CSS variables (bg-background, text-foreground)",
    "   Severity: MEDIUM",
    "",
    "6. Excessive any Types",
    "   Pattern: : any (more than 50 files)",
    "   Fix: Add proper type definitions",
    "   Severity: LOW",
    "",
    "7. @ts-ignore Usage",
    "   Pattern: @ts-ignore, @ts-expect-error (more than 5 files)",
    "   Fix: Fix type errors instead of ignoring",
    "   Severity: MEDIUM",
    "",
    "8. Missing Null Checks",
    "   Pattern: Property access without optional chaining",
    "   Fix: Use ?. and ?? operators",
    "   Severity: INFO",
    "",
    "9. TypeScript Compilation",
    "   Command: npx tsc --noEmit",
    "   Fix: Fix reported type errors",
    "   Severity: HIGH",
    "",
    "10. ESLint",
    "    Command: npx eslint src/",
    "    Fix: Run npx eslint src/ --fix",
    "    Severity: HIGH",
    "",
    "11. ThreadList Text Truncation",
    "    Pattern: thread.title without length check and ellipsis",
    "    Fix: Implement 10-character truncation with ellipsis",
    "    Severity: MEDIUM",
    "",
    "12. Form Component Theme Consistency",
    "    Pattern: SelectTrigger without bg-accent, Switch without border-input, Textarea without bg-background",
    "    Fix: Add proper theme classes for consistency",
    "    Severity: MEDIUM",
    "",
    "13. Card Width Issues",
    "    Pattern: Card components without w-full in ThreadList contexts",
    "    Fix: Add w-full class to ensure proper container fitting",
    "    Severity: LOW",
    "",
    "14. Dashboard Component Usage",
    "    Pattern: Dashboard pages not using AIPoweredDashboard component",
    "    Fix: Import AIPoweredDashboard and provide role-specific config props",
    "    Severity: HIGH",
    "",
    "15. Legacy Dashboard References",
    "    Pattern: Imports from /features/dashboard/ folders (deleted during cleanup)",
    "    Fix: Remove imports, update to use AIPoweredDashboard",
    "    Severity: CRITICAL",
    "",
    "16. Subscription Tier Enforcement",
    "    Pattern: Features without requiredSubscription check or FeatureGate wrapper",
    "    Fix: Add FeatureGate component or check tierMeetsRequirement",
    "    Severity: HIGH",
    "",
    "17. Quota Enforcement Missing",
    "    Pattern: AI RPC calls without checkUserQuota pre-flight check",
    "    Fix: Add quota check before expensive operations",
    "    Severity: HIGH",
    "",
    "18. Documentation Organization",
    "    Pattern: Markdown files in root directory instead of docs/",
    "    Fix: Move to docs/ with proper sequential numbering (0-26)",
    "    Severity: MEDIUM",
    "",
    "=== EXIT CODES ===",
    "0 - All checks passed",
    "1 - Critical or high priority issues found",
    "",
    "=== INTEGRATION ===",
    "Pre-commit: git hook (recommended)",
    "Pre-push: git hook (recommended)",
    "CI/CD: GitHub Actions (.github/workflows/code-quality.yml)",
    "Local: npm run quality-check",
    "",
    "=== CUSTOMIZATION ===",
    "Edit: scripts/code-quality-bot.cjs",
    "Add checks: Create new check*() method",
    "Adjust severity: Modify this.issues.{level}.push()",
    "Ignore files: Add patterns to .gitignore or bot config",
    "",
    "=== RECENT UPDATES (v3.0) ===",
    "Added AI-Powered Dashboard validation (Jan 28, 2025)",
    "Verify all dashboards use AIPoweredDashboard component with consistent prop structure",
    "Check dashboard stats include sparklines (trendData array with 6 values)",
    "Validate Project Details panel is conditional (selectedProject state) and dismissible",
    "Ensure conversation list has search, tabs (All/Starred), and delete on hover",
    "Verify quick actions toolbar is scrollable with role-appropriate actions (6 per role)",
    "Check no legacy dashboard folders exist (all removed during cleanup)",
    "Validate subscription routes redirect properly to settings (temporary)",
    "Ensure SubscriptionManagement component exists at src/components/portal/shared/",
    "Check quota enforcement in useAiStore.ts sendMessage function",
    "Verify Feature Gate component usage for subscription tier requirements",
    "Validate all imports reference correct paths (no dangling refs to deleted files)",
    "Updated total checks from 13 to 18 to include unified portal architecture",
    "Dashboard Reference: src/components/portal/shared/AIPoweredDashboard.tsx (361 lines)",
    "Dashboard Entries: src/pages/4-free/1-DashboardPage.tsx (92), 5-engineer/1-DashboardPage.tsx (71), 6-enterprise/1-DashboardPage.tsx (72)",
    "=== ROUTING GUARDRAILS (AI TOOLS) ===",
    "Nested routes MUST render using <Outlet /> in parent components when child routes exist.",
    "AI Tools pattern: '/free/ai-tools/{section}/{tool}' â€” tools under 'planning' MUST be nested under the 'planning' route (e.g., <Route path=\"planning\"> <Route path=\"gantt\" ... />).",
    "Route precedence: define more specific child routes BEFORE their parent siblings in the same switch/segment.",
    "Catch-all routes (path=\"*\") MUST be last and MUST NOT intercept '/free/ai-tools/**'.",
    "Automated hint: flag occurrences where <Route path=\"planning/gantt\" .../> appears as a sibling of <Route path=\"planning\" .../> instead of nested.",
    "Required files to check: src/routes/RoleRouter.tsx, src/pages/4-free/15-AIToolsPlanningPage.tsx (ensure Outlet imported and rendered).",
    "",
    "=== UNIFIED PORTAL GUARDRAILS (v4.0) ===",
    "Dashboard pages MUST import AIPoweredDashboard from src/components/portal/shared/AIPoweredDashboard.tsx",
    "Dashboard props MUST include: role, userName, stats (with trendData), quickActions, projects, conversations, aiWelcomeMessage",
    "Stats MUST include trendData array with 6 values for sparkline visualization",
    "Projects MUST include status field matching ProjectConfig interface",
    "Subscription redirects: /free/subscription â†’ /free/settings, /engineer/subscription â†’ /engineer/settings (temporary)",
    "NO imports from deleted paths: /features/dashboard/, 14-SubscriptionPage.tsx, 15-SubscriptionPage.tsx, 16-SubscriptionPage.tsx",
    "Feature gating: Premium features MUST use FeatureGate component or tierMeetsRequirement function",
    "Quota checks: AI RPC calls MUST check quota via checkUserQuota before invocation",
    "Documentation: All markdown files MUST be in docs/ with numbering 0-26, NO markdown in root directory"
  ]
}

